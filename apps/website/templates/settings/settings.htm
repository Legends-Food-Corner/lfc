{% extends 'layout/layout.htm' %}
{% from "utilities/heading-with-underline/heading-with-underline.htm" import heading_with_underline with context %}
{% from "utilities/heading-with-toggle/heading-with-toggle.htm" import heading_with_toggle with context %}

{% block title %}
Settings
{% endblock %}

{% block stylesheet %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/settings/style.css') }}">
{% endblock %}

{% block head_scripts %}
<script src="{{ url_for('static', filename='javascript/extras/lc_switch.js') }}"></script>
{% endblock %}

{% block content %}

<div class="container-fluid">
    <div class="container">
        <div class="row">
            <div class="col-sm-3">
                <div class="custom-card">
                    <div class="custom-card-body">
                        <ul class="settings-sidemenu">
                            <li>Profile</li>
                            <li>Appearance</li>
                            <li>Password</li>
                            <li>Notifications</li>
                            <hr>
                            <li><button class="btn custom-btn-danger"><i class="bi bi-trash3-fill"></i> DELETE
                                    ACCOUNT</button></li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="col-sm-9">
                <!--Profile-->
                <div class="row">
                    <div class="col">
                        <div class="custom-card">
                            <div class="custom-card-body">
                                {{ heading_with_underline("Profile") }}
                            </div>
                        </div>
                    </div>
                </div>
                <!--Appearance-->
                <div class="row">
                    <div class="col">
                        <div class="custom-card">
                            <div class="custom-card-body">
                                {{ heading_with_underline("Appearance") }}

                                {{ heading_with_toggle("Dark Mode","checkbox-theme") }}
                            </div>
                        </div>
                    </div>
                </div>
                <!--Passwords-->
                <div class="row">
                    <div class="col">
                        <div class="custom-card">
                            <div class="custom-card-body">
                                {{ heading_with_underline("Password") }}
                            </div>
                        </div>
                    </div>
                </div>
                <!--Notifications-->
                <div class="row">
                    <div class="col">
                        <div class="custom-card">
                            <div class="custom-card-body">
                                {{ heading_with_underline("Notifications") }}

                                {{ heading_with_toggle("Email","checkbox-notification-email") }}
                                {{ heading_with_toggle("SMS","checkbox-notification-sms") }}
                                {{ heading_with_toggle("Whatsapp","checkbox-notification-whatsapp") }}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

{% endblock %}

{% block body_scripts %}
<script>
    let element = document.querySelector("#checkbox-theme");

    lc_switch("input[type=checkbox]");

    let currentTheme = '{{appTheme}}';
    if (currentTheme == null || currentTheme == "dark") {
        lcs_on(element);
    }
    else {
        lcs_off(element);
    }

    element.addEventListener('lcs-statuschange', (e) => {
        let newThemeValue = document.getElementById("checkbox-theme").checked ? "dark" : "light";

        const d = new Date();
        d.setTime(d.getTime() + (30 * 24 * 60 * 60 * 1000));
        let expires = "expires=" + d.toUTCString();
        document.cookie = "app-theme" + "=" + newThemeValue + ";" + expires + ";path=/";

        localStorage.setItem("current-theme", newThemeValue);

        location.reload();
    })
</script>
{% endblock %}